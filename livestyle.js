/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/**
 * @license
 * Lo-Dash 1.2.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash modern -o ./dist/lodash.js`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.4.4 <http://underscorejs.org/>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
 * Available under MIT license <http://lodash.com/license>
 */

(function(t,n){t.livestyle=n()})(this,function(){var t,n,e;return function(r){function a(t,n){return x.call(t,n)}function i(t,n){var e,r,a,i,u,o,c,f,l,s,p=n&&n.split("/"),h=y.map,v=h&&h["*"]||{};if(t&&"."===t.charAt(0))if(n){for(p=p.slice(0,p.length-1),t=p.concat(t.split("/")),f=0;t.length>f;f+=1)if(s=t[f],"."===s)t.splice(f,1),f-=1;else if(".."===s){if(1===f&&(".."===t[2]||".."===t[0]))break;f>0&&(t.splice(f-1,2),f-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||v)&&h){for(e=t.split("/"),f=e.length;f>0;f-=1){if(r=e.slice(0,f).join("/"),p)for(l=p.length;l>0;l-=1)if(a=h[p.slice(0,l).join("/")],a&&(a=a[r])){i=a,u=f;break}if(i)break;!o&&v&&v[r]&&(o=v[r],c=f)}!i&&o&&(i=o,u=c),i&&(e.splice(0,u,i),t=e.join("/"))}return t}function u(t,n){return function(){return h.apply(r,_.call(arguments,0).concat([t,n]))}}function o(t){return function(n){return i(n,t)}}function c(t){return function(n){m[t]=n}}function f(t){if(a(d,t)){var n=d[t];delete d[t],b[t]=!0,p.apply(r,n)}if(!a(m,t)&&!a(b,t))throw Error("No "+t);return m[t]}function l(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function s(t){return function(){return y&&y.config&&y.config[t]||{}}}var p,h,v,g,m={},d={},y={},b={},x=Object.prototype.hasOwnProperty,_=[].slice;v=function(t,n){var e,r=l(t),a=r[0];return t=r[1],a&&(a=i(a,n),e=f(a)),a?t=e&&e.normalize?e.normalize(t,o(n)):i(t,n):(t=i(t,n),r=l(t),a=r[0],t=r[1],a&&(e=f(a))),{f:a?a+"!"+t:t,n:t,pr:a,p:e}},g={require:function(t){return u(t)},exports:function(t){var n=m[t];return n!==void 0?n:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:s(t)}}},p=function(t,n,e,i){var o,l,s,p,h,y,x=[];if(i=i||t,"function"==typeof e){for(n=!n.length&&e.length?["require","exports","module"]:n,h=0;n.length>h;h+=1)if(p=v(n[h],i),l=p.f,"require"===l)x[h]=g.require(t);else if("exports"===l)x[h]=g.exports(t),y=!0;else if("module"===l)o=x[h]=g.module(t);else if(a(m,l)||a(d,l)||a(b,l))x[h]=f(l);else{if(!p.p)throw Error(t+" missing "+l);p.p.load(p.n,u(i,!0),c(l),{}),x[h]=m[l]}s=e.apply(m[t],x),t&&(o&&o.exports!==r&&o.exports!==m[t]?m[t]=o.exports:s===r&&y||(m[t]=s))}else t&&(m[t]=e)},t=n=h=function(t,n,e,a,i){return"string"==typeof t?g[t]?g[t](n):f(v(t,n).f):(t.splice||(y=t,n.splice?(t=n,n=e,e=null):t=r),n=n||function(){},"function"==typeof e&&(e=a,a=i),a?p(r,t,n,e):setTimeout(function(){p(r,t,n,e)},4),h)},h.config=function(t){return y=t,y.deps&&h(y.deps,y.callback),h},e=function(t,n,e){n.splice||(e=n,n=[]),a(m,t)||a(d,t)||(d[t]=[t,n,e])},e.amd={jQuery:!0}}(),e("backend/almond",function(){}),function(t){function n(e){function a(t){return t&&"object"==typeof t&&!yr(t)&&Ze.call(t,"__wrapped__")?t:new M(t)}function u(t){var n=t.length,e=n>=l;if(e)for(var r={},a=-1;n>++a;){var i=f+t[a];(r[i]||(r[i]=[])).push(t[a])}return function(n){if(e){var a=f+n;return r[a]&&Kn(r[a],n)>-1}return Kn(t,n)>-1}}function P(t){return t.charCodeAt(0)}function z(t,n){var e=t.index,a=n.index;if(t=t.criteria,n=n.criteria,t!==n){if(t>n||t===r)return 1;if(n>t||n===r)return-1}return a>e?-1:1}function F(t,n,e,r){function a(){var r=arguments,f=u?this:n;if(i||(t=n[o]),e.length&&(r=r.length?(r=hr.call(r),c?r.concat(e):e.concat(r)):e),this instanceof a){D.prototype=t.prototype,f=new D,D.prototype=null;var l=t.apply(f,r);return cn(l)?l:f}return t.apply(f,r)}var i=on(t),u=!e,o=n;if(u){var c=r;e=n}else if(!i){if(!r)throw new De;n=t}return a}function U(t){return"\\"+B[t]}function L(t){return _r[t]}function M(t){this.__wrapped__=t}function D(){}function J(t){var n=!1;if(!t||rr.call(t)!=A)return n;var e=t.constructor;return(on(e)?e instanceof e:!0)?(jr(t,function(t,e){n=e}),n===!1||Ze.call(t,n)):n}function V(t,n,e){n||(n=0),e===r&&(e=t?t.length:0);for(var a=-1,i=e-n||0,u=$e(0>i?0:i);i>++a;)u[a]=t[n+a];return u}function K(t){return kr[t]}function Q(t){return rr.call(t)==j}function G(t,n,e,i,u,o){var c=t;if("function"==typeof n&&(i=e,e=n,n=!1),"function"==typeof e){if(e=i===r?e:a.createCallback(e,i,1),c=e(c),c!==r)return c;c=t}var f=cn(c);if(f){var l=rr.call(c);if(!$[l])return c;var s=yr(c)}if(!f||!n)return f?s?V(c):Cr({},c):c;var p=mr[l];switch(l){case R:case O:return new p(+c);case E:case q:return new p(c);case N:return p(c.source,m.exec(c))}u||(u=[]),o||(o=[]);for(var h=u.length;h--;)if(u[h]==t)return o[h];return c=s?p(c.length):{},s&&(Ze.call(t,"index")&&(c.index=t.index),Ze.call(t,"input")&&(c.input=t.input)),u.push(t),o.push(c),(s?Sn:Sr)(t,function(t,a){c[a]=G(t,n,e,r,u,o)}),c}function H(t,n,e){return G(t,!0,n,e)}function W(t,n,e){var i;return n=a.createCallback(n,e),Sr(t,function(t,e,a){return n(t,e,a)?(i=e,!1):r}),i}function X(t){var n=[];return jr(t,function(t,e){on(t)&&n.push(e)}),n.sort()}function Y(t,n){return t?Ze.call(t,n):!1}function Z(t){for(var n=-1,e=xr(t),r=e.length,a={};r>++n;){var i=e[n];a[t[i]]=i}return a}function tn(t){return t===!0||t===!1||rr.call(t)==R}function nn(t){return t?"object"==typeof t&&rr.call(t)==O:!1}function en(t){return t?1===t.nodeType:!1}function rn(t){var n=!0;if(!t)return n;var e=rr.call(t),r=t.length;return e==S||e==q||e==j||e==A&&"number"==typeof r&&on(t.splice)?!r:(Sr(t,function(){return n=!1}),n)}function an(t,n,e,i,u,o){var f=e===c;if("function"==typeof e&&!f){e=a.createCallback(e,i,2);var l=e(t,n);if(l!==r)return!!l}if(t===n)return 0!==t||1/t==1/n;var s=typeof t,p=typeof n;if(t===t&&(!t||"function"!=s&&"object"!=s)&&(!n||"function"!=p&&"object"!=p))return!1;if(null==t||null==n)return t===n;var h=rr.call(t),v=rr.call(n);if(h==j&&(h=A),v==j&&(v=A),h!=v)return!1;switch(h){case R:case O:return+t==+n;case E:return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case N:case q:return t==Me(n)}var g=h==S;if(!g){if(Ze.call(t,"__wrapped__ ")||Ze.call(n,"__wrapped__"))return an(t.__wrapped__||t,n.__wrapped__||n,e,i,u,o);if(h!=A)return!1;var m=t.constructor,d=n.constructor;if(m!=d&&!(on(m)&&m instanceof m&&on(d)&&d instanceof d))return!1}u||(u=[]),o||(o=[]);for(var y=u.length;y--;)if(u[y]==t)return o[y]==n;var b=0;if(l=!0,u.push(t),o.push(n),g){if(y=t.length,b=n.length,l=b==t.length,!l&&!f)return l;for(;b--;){var x=y,_=n[b];if(f)for(;x--&&!(l=an(t[x],_,e,i,u,o)););else if(!(l=an(t[b],_,e,i,u,o)))break}return l}return jr(n,function(n,a,c){return Ze.call(c,a)?(b++,l=Ze.call(t,a)&&an(t[a],n,e,i,u,o)):r}),l&&!f&&jr(t,function(t,n,e){return Ze.call(e,n)?l=--b>-1:r}),l}function un(t){return ur(t)&&!or(parseFloat(t))}function on(t){return"function"==typeof t}function cn(t){return t?T[typeof t]:!1}function fn(t){return sn(t)&&t!=+t}function ln(t){return null===t}function sn(t){return"number"==typeof t||rr.call(t)==E}function pn(t){return t?"object"==typeof t&&rr.call(t)==N:!1}function hn(t){return"string"==typeof t||rr.call(t)==q}function vn(t){return t===r}function gn(t,n,e){var i=arguments,u=0,o=2;if(!cn(t))return t;if(e===c)var f=i[3],l=i[4],s=i[5];else l=[],s=[],"number"!=typeof e&&(o=i.length),o>3&&"function"==typeof i[o-2]?f=a.createCallback(i[--o-1],i[o--],2):o>2&&"function"==typeof i[o-1]&&(f=i[--o]);for(;o>++u;)(yr(i[u])?Sn:Sr)(i[u],function(n,e){var a,i,u=n,o=t[e];if(n&&((i=yr(n))||Rr(n))){for(var p=l.length;p--;)if(a=l[p]==n){o=s[p];break}if(!a){var h;f&&(u=f(o,n),(h=u!==r)&&(o=u)),h||(o=i?yr(o)?o:[]:Rr(o)?o:{}),l.push(n),s.push(o),h||(o=gn(o,n,c,f,l,s))}}else f&&(u=f(o,n),u===r&&(u=n)),u!==r&&(o=u);t[e]=o});return t}function mn(t,n,e){var r="function"==typeof n,i={};if(r)n=a.createCallback(n,e);else var u=We.apply(Je,hr.call(arguments,1));return jr(t,function(t,e,a){(r?!n(t,e,a):0>Kn(u,e))&&(i[e]=t)}),i}function dn(t){for(var n=-1,e=xr(t),r=e.length,a=$e(r);r>++n;){var i=e[n];a[n]=[i,t[i]]}return a}function yn(t,n,e){var r={};if("function"!=typeof n)for(var i=-1,u=We.apply(Je,hr.call(arguments,1)),o=cn(t)?u.length:0;o>++i;){var c=u[i];c in t&&(r[c]=t[c])}else n=a.createCallback(n,e),jr(t,function(t,e,a){n(t,e,a)&&(r[e]=t)});return r}function bn(t){for(var n=-1,e=xr(t),r=e.length,a=$e(r);r>++n;)a[n]=t[e[n]];return a}function xn(t){for(var n=-1,e=We.apply(Je,hr.call(arguments,1)),r=e.length,a=$e(r);r>++n;)a[n]=t[e[n]];return a}function _n(t,n,e){var a=-1,i=t?t.length:0,u=!1;return e=(0>e?fr(0,i+e):e)||0,"number"==typeof i?u=(hn(t)?t.indexOf(n,e):Kn(t,n,e))>-1:Sr(t,function(t){return++a>=e?!(u=t===n):r}),u}function kn(t,n,e){var r={};return n=a.createCallback(n,e),Sn(t,function(t,e,a){e=Me(n(t,e,a)),Ze.call(r,e)?r[e]++:r[e]=1}),r}function Cn(t,n,e){var r=!0;n=a.createCallback(n,e);var i=-1,u=t?t.length:0;if("number"==typeof u)for(;u>++i&&(r=!!n(t[i],i,t)););else Sr(t,function(t,e,a){return r=!!n(t,e,a)});return r}function wn(t,n,e){var r=[];n=a.createCallback(n,e);var i=-1,u=t?t.length:0;if("number"==typeof u)for(;u>++i;){var o=t[i];n(o,i,t)&&r.push(o)}else Sr(t,function(t,e,a){n(t,e,a)&&r.push(t)});return r}function jn(t,n,e){n=a.createCallback(n,e);var i=-1,u=t?t.length:0;if("number"!=typeof u){var o;return Sr(t,function(t,e,a){return n(t,e,a)?(o=t,!1):r}),o}for(;u>++i;){var c=t[i];if(n(c,i,t))return c}}function Sn(t,n,e){var i=-1,u=t?t.length:0;if(n=n&&e===r?n:a.createCallback(n,e),"number"==typeof u)for(;u>++i&&n(t[i],i,t)!==!1;);else Sr(t,n);return t}function Rn(t,n,e){var r={};return n=a.createCallback(n,e),Sn(t,function(t,e,a){e=Me(n(t,e,a)),(Ze.call(r,e)?r[e]:r[e]=[]).push(t)}),r}function On(t,n){var e=hr.call(arguments,2),r=-1,a="function"==typeof n,i=t?t.length:0,u=$e("number"==typeof i?i:0);return Sn(t,function(t){u[++r]=(a?n:t[n]).apply(t,e)}),u}function Pn(t,n,e){var r=-1,i=t?t.length:0;if(n=a.createCallback(n,e),"number"==typeof i)for(var u=$e(i);i>++r;)u[r]=n(t[r],r,t);else u=[],Sr(t,function(t,e,a){u[++r]=n(t,e,a)});return u}function En(t,n,e){var r=-1/0,i=r;if(!n&&yr(t))for(var u=-1,o=t.length;o>++u;){var c=t[u];c>i&&(i=c)}else n=!n&&hn(t)?P:a.createCallback(n,e),Sn(t,function(t,e,a){var u=n(t,e,a);u>r&&(r=u,i=t)});return i}function An(t,n,e){var r=1/0,i=r;if(!n&&yr(t))for(var u=-1,o=t.length;o>++u;){var c=t[u];i>c&&(i=c)}else n=!n&&hn(t)?P:a.createCallback(n,e),Sn(t,function(t,e,a){var u=n(t,e,a);r>u&&(r=u,i=t)});return i}function Nn(t,n){var e=-1,r=t?t.length:0;if("number"==typeof r)for(var a=$e(r);r>++e;)a[e]=t[e][n];return a||Pn(t,n)}function qn(t,n,e,r){if(!t)return e;var i=3>arguments.length;n=a.createCallback(n,r,4);var u=-1,o=t.length;if("number"==typeof o)for(i&&(e=t[++u]);o>++u;)e=n(e,t[u],u,t);else Sr(t,function(t,r,a){e=i?(i=!1,t):n(e,t,r,a)});return e}function $n(t,n,e,r){var i=t,u=t?t.length:0,o=3>arguments.length;if("number"!=typeof u){var c=xr(t);u=c.length}return n=a.createCallback(n,r,4),Sn(t,function(t,r,a){r=c?c[--u]:--u,e=o?(o=!1,i[r]):n(e,i[r],r,a)}),e}function Tn(t,n,e){return n=a.createCallback(n,e),wn(t,function(t,e,r){return!n(t,e,r)})}function Bn(t){var n=-1,e=t?t.length:0,r=$e("number"==typeof e?e:0);return Sn(t,function(t){var e=Xe(pr()*(++n+1));r[n]=r[e],r[e]=t}),r}function In(t){var n=t?t.length:0;return"number"==typeof n?n:xr(t).length}function zn(t,n,e){var r;n=a.createCallback(n,e);var i=-1,u=t?t.length:0;if("number"==typeof u)for(;u>++i&&!(r=n(t[i],i,t)););else Sr(t,function(t,e,a){return!(r=n(t,e,a))});return!!r}function Fn(t,n,e){var r=-1,i=t?t.length:0,u=$e("number"==typeof i?i:0);for(n=a.createCallback(n,e),Sn(t,function(t,e,a){u[++r]={criteria:n(t,e,a),index:r,value:t}}),i=u.length,u.sort(z);i--;)u[i]=u[i].value;return u}function Un(t){return t&&"number"==typeof t.length?V(t):bn(t)}function Ln(t){for(var n=-1,e=t?t.length:0,r=[];e>++n;){var a=t[n];a&&r.push(a)}return r}function Mn(t){for(var n=-1,e=t?t.length:0,r=We.apply(Je,hr.call(arguments,1)),a=u(r),i=[];e>++n;){var o=t[n];a(o)||i.push(o)}return i}function Dn(t,n,e){var r=-1,i=t?t.length:0;for(n=a.createCallback(n,e);i>++r;)if(n(t[r],r,t))return r;return-1}function Jn(t,n,e){if(t){var r=0,i=t.length;if("number"!=typeof n&&null!=n){var u=-1;for(n=a.createCallback(n,e);i>++u&&n(t[u],u,t);)r++}else if(r=n,null==r||e)return t[0];return V(t,0,lr(fr(0,r),i))}}function Vn(t,n,e,r){var i=-1,u=t?t.length:0,o=[];for("boolean"!=typeof n&&null!=n&&(r=e,e=n,n=!1),null!=e&&(e=a.createCallback(e,r));u>++i;){var c=t[i];e&&(c=e(c,i,t)),yr(c)?tr.apply(o,n?c:Vn(c)):o.push(c)}return o}function Kn(t,n,e){var r=-1,a=t?t.length:0;if("number"==typeof e)r=(0>e?fr(0,a+e):e||0)-1;else if(e)return r=Zn(t,n),t[r]===n?r:-1;for(;a>++r;)if(t[r]===n)return r;return-1}function Qn(t,n,e){if(!t)return[];var r=0,i=t.length;if("number"!=typeof n&&null!=n){var u=i;for(n=a.createCallback(n,e);u--&&n(t[u],u,t);)r++}else r=null==n||e?1:n||r;return V(t,0,lr(fr(0,i-r),i))}function Gn(t){var n=arguments,e=n.length,r={0:{}},a=-1,i=t?t.length:0,o=i>=l,c=[],s=c;t:for(;i>++a;){var p=t[a];if(o)var h=f+p,v=r[0][h]?!(s=r[0][h]):s=r[0][h]=[];if(v||0>Kn(s,p)){o&&s.push(p);for(var g=e;--g;)if(!(r[g]||(r[g]=u(n[g])))(p))continue t;c.push(p)}}return c}function Hn(t,n,e){if(t){var r=0,i=t.length;if("number"!=typeof n&&null!=n){var u=i;for(n=a.createCallback(n,e);u--&&n(t[u],u,t);)r++}else if(r=n,null==r||e)return t[i-1];return V(t,fr(0,i-r))}}function Wn(t,n,e){var r=t?t.length:0;for("number"==typeof e&&(r=(0>e?fr(0,r+e):lr(e,r-1))+1);r--;)if(t[r]===n)return r;return-1}function Xn(t,n,e){t=+t||0,e=+e||1,null==n&&(n=t,t=0);for(var r=-1,a=fr(0,Ge((n-t)/e)),i=$e(a);a>++r;)i[r]=t,t+=e;return i}function Yn(t,n,e){if("number"!=typeof n&&null!=n){var r=0,i=-1,u=t?t.length:0;for(n=a.createCallback(n,e);u>++i&&n(t[i],i,t);)r++}else r=null==n||e?1:fr(0,n);return V(t,r)}function Zn(t,n,e,r){var i=0,u=t?t.length:i;for(e=e?a.createCallback(e,r,1):ke,n=e(n);u>i;){var o=i+u>>>1;n>e(t[o])?i=o+1:u=o}return i}function te(t){return yr(t)||(arguments[0]=t?hr.call(t):Je),ne(We.apply(Je,arguments))}function ne(t,n,e,r){var i=-1,u=t?t.length:0,o=[],c=o;"boolean"!=typeof n&&null!=n&&(r=e,e=n,n=!1);var s=!n&&u>=l;if(s)var p={};for(null!=e&&(c=[],e=a.createCallback(e,r));u>++i;){var h=t[i],v=e?e(h,i,t):h;if(s)var g=f+v,m=p[g]?!(c=p[g]):c=p[g]=[];(n?!i||c[c.length-1]!==v:m||0>Kn(c,v))&&((e||s)&&c.push(v),o.push(h))}return o}function ee(t){for(var n=-1,e=t?t.length:0,r=e?En(Nn(t,"length")):0,a=$e(r);e>++n;)for(var i=-1,u=t[n];r>++i;)(a[i]||(a[i]=$e(e)))[n]=u[i];return a}function re(t){return Mn(t,hr.call(arguments,1))}function ae(t){for(var n=-1,e=t?En(Nn(arguments,"length")):0,r=$e(e);e>++n;)r[n]=Nn(arguments,n);return r}function ie(t,n){for(var e=-1,r=t?t.length:0,a={};r>++e;){var i=t[e];n?a[i]=n[e]:a[i[0]]=i[1]}return a}function ue(t,n){return 1>t?n():function(){return 1>--t?n.apply(this,arguments):r}}function oe(t,n){return dr.fastBind||ar&&arguments.length>2?ar.call.apply(ar,arguments):F(t,n,hr.call(arguments,2))}function ce(t){for(var n=arguments.length>1?We.apply(Je,hr.call(arguments,1)):X(t),e=-1,r=n.length;r>++e;){var a=n[e];t[a]=oe(t[a],t)}return t}function fe(t,n){return F(t,n,hr.call(arguments,2),c)}function le(){var t=arguments;return function(){for(var n=arguments,e=t.length;e--;)n=[t[e].apply(this,n)];return n[0]}}function se(t,n,e){if(null==t)return ke;var a=typeof t;if("function"!=a){if("object"!=a)return function(n){return n[t]};var i=xr(t);return function(n){for(var e=i.length,r=!1;e--&&(r=an(n[i[e]],t[i[e]],c)););return r}}return n!==r?1===e?function(e){return t.call(n,e)}:2===e?function(e,r){return t.call(n,e,r)}:4===e?function(e,r,a,i){return t.call(n,e,r,a,i)}:function(e,r,a){return t.call(n,e,r,a)}:t}function pe(t,n,e){function r(){i=c=null,f&&(u=t.apply(o,a))}var a,i,u,o,c,f=!0;if(e===!0){var l=!0;f=!1}else e&&T[typeof e]&&(l=e.leading,f="trailing"in e?e.trailing:f);return function(){return a=arguments,o=this,He(c),!i&&l?(i=!0,u=t.apply(o,a)):c=er(r,n),u}}function he(t){var n=hr.call(arguments,1);return er(function(){t.apply(r,n)},1)}function ve(t,n){var e=hr.call(arguments,2);return er(function(){t.apply(r,e)},n)}function ge(t,n){var e={};return function(){var r=f+(n?n.apply(this,arguments):arguments[0]);return Ze.call(e,r)?e[r]:e[r]=t.apply(this,arguments)}}function me(t){var n,e;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}}function de(t){return F(t,hr.call(arguments,1))}function ye(t){return F(t,hr.call(arguments,1),null,c)}function be(t,n,e){function r(){o=null,l&&(c=new Be,i=t.apply(u,a))}var a,i,u,o,c=0,f=!0,l=!0;return e===!1?f=!1:e&&T[typeof e]&&(f="leading"in e?e.leading:f,l="trailing"in e?e.trailing:l),function(){var e=new Be;o||f||(c=e);var l=n-(e-c);return a=arguments,u=this,0>=l?(He(o),o=null,c=e,i=t.apply(u,a)):o||(o=er(r,l)),i}}function xe(t,n){return function(){var e=[t];return tr.apply(e,arguments),n.apply(this,e)}}function _e(t){return null==t?"":Me(t).replace(_,L)}function ke(t){return t}function Ce(t){Sn(X(t),function(n){var e=a[n]=t[n];a.prototype[n]=function(){var t=this.__wrapped__,n=[t];tr.apply(n,arguments);var r=e.apply(a,n);return t&&"object"==typeof t&&t==r?this:new M(r)}})}function we(){return e._=Ke,this}function je(t,n){return null==t&&null==n&&(n=1),t=+t||0,null==n&&(n=t,t=0),t+Xe(pr()*((+n||0)-t+1))}function Se(t,n){var e=t?t[n]:r;return on(e)?t[n]():e}function Re(t,n,e){var i=a.templateSettings;t||(t=""),e=wr({},e,i);var u,o=wr({},e.imports,i.imports),c=xr(o),f=bn(o),l=0,v=e.interpolate||x,m="__p += '",y=Le((e.escape||x).source+"|"+v.source+"|"+(v===d?g:x).source+"|"+(e.evaluate||x).source+"|$","g");t.replace(y,function(n,e,r,a,i,o){return r||(r=a),m+=t.slice(l,o).replace(k,U),e&&(m+="' +\n__e("+e+") +\n'"),i&&(u=!0,m+="';\n"+i+";\n__p += '"),r&&(m+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=o+n.length,n}),m+="';\n";var b=e.variable,_=b;_||(b="obj",m="with ("+b+") {\n"+m+"\n}\n"),m=(u?m.replace(s,""):m).replace(p,"$1").replace(h,"$1;"),m="function("+b+") {\n"+(_?"":b+" || ("+b+" = {});\n")+"var __t, __p = '', __e = _.escape"+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var C="\n/*\n//@ sourceURL="+(e.sourceURL||"/lodash/template/source["+w++ +"]")+"\n*/";try{var j=Ie(c,"return "+m+C).apply(r,f)}catch(S){throw S.source=m,S}return n?j(n):(j.source=m,j)}function Oe(t,n,e){t=(t=+t)>-1?t:0;var r=-1,i=$e(t);for(n=a.createCallback(n,e,1);t>++r;)i[r]=n(r);return i}function Pe(t){return null==t?"":Me(t).replace(v,K)}function Ee(t){var n=++o;return Me(null==t?"":t)+n}function Ae(t,n){return n(t),t}function Ne(){return Me(this.__wrapped__)}function qe(){return this.__wrapped__}e=e?I.defaults(t.Object(),e,I.pick(t,C)):t;var $e=e.Array,Te=e.Boolean,Be=e.Date,Ie=e.Function,ze=e.Math,Fe=e.Number,Ue=e.Object,Le=e.RegExp,Me=e.String,De=e.TypeError,Je=$e(),Ve=Ue(),Ke=e._,Qe=Le("^"+Me(Ve.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Ge=ze.ceil,He=e.clearTimeout,We=Je.concat,Xe=ze.floor,Ye=Qe.test(Ye=Ue.getPrototypeOf)&&Ye,Ze=Ve.hasOwnProperty,tr=Je.push,nr=e.setImmediate,er=e.setTimeout,rr=Ve.toString,ar=Qe.test(ar=rr.bind)&&ar,ir=Qe.test(ir=$e.isArray)&&ir,ur=e.isFinite,or=e.isNaN,cr=Qe.test(cr=Ue.keys)&&cr,fr=ze.max,lr=ze.min,sr=e.parseInt,pr=ze.random,hr=Je.slice,vr=Qe.test(e.attachEvent),gr=ar&&!/\n|true/.test(ar+vr),mr={};mr[S]=$e,mr[R]=Te,mr[O]=Be,mr[A]=Ue,mr[E]=Fe,mr[N]=Le,mr[q]=Me;var dr=a.support={};dr.fastBind=ar&&!gr,a.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:d,variable:"",imports:{_:a}},M.prototype=a.prototype;var yr=ir,br=function(t){var n,e=t,r=[];if(!e)return r;if(!T[typeof t])return r;for(n in e)Ze.call(e,n)&&r.push(n);return r},xr=cr?function(t){return cn(t)?cr(t):[]}:br,_r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},kr=Z(_r),Cr=function(t,n,e){var r,i=t,u=i;if(!i)return u;var o=arguments,c=0,f="number"==typeof e?2:o.length;if(f>3&&"function"==typeof o[f-2])var l=a.createCallback(o[--f-1],o[f--],2);else f>2&&"function"==typeof o[f-1]&&(l=o[--f]);for(;f>++c;)if(i=o[c],i&&T[typeof i]){var s=i.length;if(r=-1,yr(i))for(;s>++r;)u[r]=l?l(u[r],i[r]):i[r];else for(var p=-1,h=T[typeof i]?xr(i):[],s=h.length;s>++p;)r=h[p],u[r]=l?l(u[r],i[r]):i[r]}return u},wr=function(t,n,e){var a,i=t,u=i;if(!i)return u;for(var o=arguments,c=0,f="number"==typeof e?2:o.length;f>++c;)if(i=o[c],i&&T[typeof i]){var l=i.length;if(a=-1,yr(i))for(;l>++a;)u[a]===r&&(u[a]=i[a]);else for(var s=-1,p=T[typeof i]?xr(i):[],l=p.length;l>++s;)a=p[s],u[a]===r&&(u[a]=i[a])}return u},jr=function(t,n,e){var i,u=t,o=u;if(!u)return o;if(!T[typeof u])return o;n=n&&e===r?n:a.createCallback(n,e);for(i in u)if(n(u[i],i,t)===!1)return o;return o},Sr=function(t,n,e){var i,u=t,o=u;if(!u)return o;if(!T[typeof u])return o;n=n&&e===r?n:a.createCallback(n,e);for(var c=-1,f=T[typeof u]?xr(u):[],l=f.length;l>++c;)if(i=f[c],n(u[i],i,t)===!1)return o;return o},Rr=function(t){if(!t||rr.call(t)!=A)return!1;var n=t.valueOf,e="function"==typeof n&&(e=Ye(n))&&Ye(e);return e?t==e||Ye(t)==e:J(t)},Or=wn;gr&&i&&"function"==typeof nr&&(he=oe(nr,e));var Pr=8==sr(y+"08")?sr:function(t,n){return sr(hn(t)?t.replace(b,""):t,n||0)};return a.after=ue,a.assign=Cr,a.at=xn,a.bind=oe,a.bindAll=ce,a.bindKey=fe,a.compact=Ln,a.compose=le,a.countBy=kn,a.createCallback=se,a.debounce=pe,a.defaults=wr,a.defer=he,a.delay=ve,a.difference=Mn,a.filter=wn,a.flatten=Vn,a.forEach=Sn,a.forIn=jr,a.forOwn=Sr,a.functions=X,a.groupBy=Rn,a.initial=Qn,a.intersection=Gn,a.invert=Z,a.invoke=On,a.keys=xr,a.map=Pn,a.max=En,a.memoize=ge,a.merge=gn,a.min=An,a.omit=mn,a.once=me,a.pairs=dn,a.partial=de,a.partialRight=ye,a.pick=yn,a.pluck=Nn,a.range=Xn,a.reject=Tn,a.rest=Yn,a.shuffle=Bn,a.sortBy=Fn,a.tap=Ae,a.throttle=be,a.times=Oe,a.toArray=Un,a.union=te,a.uniq=ne,a.unzip=ee,a.values=bn,a.where=Or,a.without=re,a.wrap=xe,a.zip=ae,a.zipObject=ie,a.collect=Pn,a.drop=Yn,a.each=Sn,a.extend=Cr,a.methods=X,a.object=ie,a.select=wn,a.tail=Yn,a.unique=ne,Ce(a),a.clone=G,a.cloneDeep=H,a.contains=_n,a.escape=_e,a.every=Cn,a.find=jn,a.findIndex=Dn,a.findKey=W,a.has=Y,a.identity=ke,a.indexOf=Kn,a.isArguments=Q,a.isArray=yr,a.isBoolean=tn,a.isDate=nn,a.isElement=en,a.isEmpty=rn,a.isEqual=an,a.isFinite=un,a.isFunction=on,a.isNaN=fn,a.isNull=ln,a.isNumber=sn,a.isObject=cn,a.isPlainObject=Rr,a.isRegExp=pn,a.isString=hn,a.isUndefined=vn,a.lastIndexOf=Wn,a.mixin=Ce,a.noConflict=we,a.parseInt=Pr,a.random=je,a.reduce=qn,a.reduceRight=$n,a.result=Se,a.runInContext=n,a.size=In,a.some=zn,a.sortedIndex=Zn,a.template=Re,a.unescape=Pe,a.uniqueId=Ee,a.all=Cn,a.any=zn,a.detect=jn,a.foldl=qn,a.foldr=$n,a.include=_n,a.inject=qn,Sr(a,function(t,n){a.prototype[n]||(a.prototype[n]=function(){var n=[this.__wrapped__];return tr.apply(n,arguments),t.apply(a,n)})}),a.first=Jn,a.last=Hn,a.take=Jn,a.head=Jn,Sr(a,function(t,n){a.prototype[n]||(a.prototype[n]=function(n,e){var r=t(this.__wrapped__,n,e);return null==n||e&&"function"!=typeof n?r:new M(r)})}),a.VERSION="1.2.1",a.prototype.toString=Ne,a.prototype.value=qe,a.prototype.valueOf=qe,Sn(["join","pop","shift"],function(t){var n=Je[t];a.prototype[t]=function(){return n.apply(this.__wrapped__,arguments)}}),Sn(["push","reverse","sort","unshift"],function(t){var n=Je[t];a.prototype[t]=function(){return n.apply(this.__wrapped__,arguments),this}}),Sn(["concat","slice","splice"],function(t){var n=Je[t];a.prototype[t]=function(){return new M(n.apply(this.__wrapped__,arguments))}}),a}var r,a="object"==typeof exports&&exports,i="object"==typeof module&&module&&module.exports==a&&module,u="object"==typeof global&&global;(u.global===u||u.window===u)&&(t=u);var o=0,c={},f=+new Date+"",l=200,s=/\b__p \+= '';/g,p=/\b(__p \+=) '' \+/g,h=/(__e\(.*?\)|\b__t\)) \+\n'';/g,v=/&(?:amp|lt|gt|quot|#39);/g,g=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,m=/\w*$/,d=/<%=([\s\S]+?)%>/g,y=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",b=RegExp("^["+y+"]*0+(?=.$)"),x=/($^)/,_=/[&<>"']/g,k=/['\n\r\t\u2028\u2029\\]/g,C=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],w=0,j="[object Arguments]",S="[object Array]",R="[object Boolean]",O="[object Date]",P="[object Function]",E="[object Number]",A="[object Object]",N="[object RegExp]",q="[object String]",$={};$[P]=!1,$[j]=$[S]=$[R]=$[O]=$[E]=$[A]=$[N]=$[q]=!0;var T={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},B={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},I=n();e("lodash",[],function(){return I})}(this),e("cssParser",[],function(){function t(t,n){return n=n||t.charCodeAt(0),n>=97&&122>=n||n>=65&&90>=n||"&"===t||"_"===t||"-"===t}function n(t,n){return n=n||t.charCodeAt(0),n>=48&&57>=n}function e(t,n){p.tokens.push({value:t,type:n||t,start:null,end:null})}function r(t){var n=h,e=p.tokens;return p.tokens=null,{name:"ParseError",message:t+" at char "+(n.chnum+1),walker:n,tokens:e}}function a(){for(var t=h.ch,n="";" "===t||"	"===t;)n+=t,t=h.nextChar();e(n,"white")}function i(){var t,n=h,r=n.ch,a=r;if(t=n.nextChar(),"/"===t){a+=t;for(var i=n.peek();i&&"\n"!==i;)a+=t,t=n.nextChar(),i=n.peek()}else{if("*"!==t)return e(a,a);for(;"*"!==r||"/"!==t;)a+=t,r=t,t=n.nextChar()}a+=t,n.nextChar(),e(a,"comment")}function u(){var t,n=h,a=n.ch,i=a,u=a;for(a=n.nextChar();a!==i;){if("\n"===a){if(t=n.nextChar(),"\\"!==t)throw r("Unterminated string");u+=a+t}else u+="\\"===a?a+n.nextChar():a;a=n.nextChar()}u+=a,n.nextChar(),e(u,"string")}function o(){var t=h,n=t.ch,a=0,i=n;for(n=t.nextChar();")"!==n&&!a;){if("("===n)a++;else if(")"===n)a--;else if(""===n)throw r("Unterminated brace");i+=n,n=t.nextChar()}i+=n,t.nextChar(),e(i,"brace")}function c(r){var a=h.ch,i=r?r+a:a;for(a=h.nextChar(),cc=a.charCodeAt(0);t(a,cc)||n(a,cc);)i+=a,a=h.nextChar(),cc=a.charCodeAt(0);e(i,"identifier")}function f(){var t,r=h,a=r.ch,i=a,u="."===i;if(a=r.nextChar(),t=!n(a),u&&t)return e(i,".");if("-"===i&&t)return c("-");for(;""!==a&&(n(a)||!u&&"."===a);)"."===a&&(u=!0),i+=a,a=r.nextChar();e(i,"number")}function l(){var t=h,n=t.ch,r=n,a=t.nextChar();return"="===a&&v(r,!0)?(r+=a,e(r,"match"),t.nextChar(),void 0):(e(r,r),void 0)}function s(){var s=h.ch;if(" "===s||"	"===s)return a();if("/"===s)return i();if('"'===s||"'"===s)return u();if("("===s)return o();if("-"===s||"."===s||n(s))return f();if(t(s))return c();if(v(s))return l();if("\r"===s)return"\n"===h.peek()&&(s+=h.nextChar()),e(s,"line"),h.nextChar(),void 0;if("\n"===s)return e(s,"line"),h.nextChar(),void 0;throw r("Unrecognized character '"+s+"'")}var p={tokens:null},h={init:function(t){this.source=t,this.ch="",this.chnum=-1,this.nextChar()},nextChar:function(){return this.ch=this.source.charAt(++this.chnum)},peek:function(){return this.source.charAt(this.chnum+1)}},v=function(){for(var t="{}[]()+*=.,;:>~|\\%$#@^!".split(""),n="*^|$~".split(""),e={},r={},a=0;t.length>a;a+=1)e[t[a]]=!0;for(a=0;n.length>a;a+=1)r[n[a]]=!0;return function(t,n){return n?t in r:t in e}}();return{lex:function(t){for(h.init(t),p.tokens=[];""!==h.ch;)s();var n=p.tokens;return p.tokens=null,n},parse:function(t){for(var n,e=this.lex(t),r=0,a=0,i=e.length;i>a;a++)n=e[a],n.start=r,n.end=r+=n.value.length;return e},toSource:function(t){for(var n=0,e=t.length,r="";e>n;n+=1)r+=t[n].value;return r}}}),e("range",["lodash"],function(t){function n(t,n,e){switch(e){case"eq":case"==":return t===n;case"lt":case"<":return n>t;case"lte":case"<=":return n>=t;case"gt":case">":return t>n;case"gte":case">=":return t>=n}}function e(n,e){"object"==typeof n&&"start"in n?(this.start=Math.min(n.start,n.end),this.end=Math.max(n.start,n.end)):t.isArray(n)?(this.start=n[0],this.end=n[1]):(e="string"==typeof n?e.length:+e,this.start=n,this.end=n+e)}return e.prototype={length:function(){return this.end-this.start},equal:function(t){return this.cmp(t,"eq","eq")},shift:function(t){return this.start+=t,this.end+=t,this},overlap:function(t){return t.start<=this.end&&t.end>=this.start},intersection:function(t){if(this.overlap(t)){var n=Math.max(t.start,this.start),r=Math.min(t.end,this.end);return new e(n,r-n)}return null},union:function(t){if(this.overlap(t)){var n=Math.min(t.start,this.start),r=Math.max(t.end,this.end);return new e(n,r-n)}return null},inside:function(t){return this.cmp(t,"lte","gt")},contains:function(t){return this.cmp(t,"lt","gt")},include:function(t){return this.cmp(t,"lte","gte")},cmp:function(t,r,a){var i,u;return t instanceof e?(i=t.start,u=t.end):i=u=t,n(this.start,i,r||"<=")&&n(this.end,u,a||">")},substring:function(t){return this.length()>0?t.substring(this.start,this.end):""},clone:function(){return new e(this.start,this.length())},toArray:function(){return[this.start,this.end]},toString:function(){return this.valueOf()},valueOf:function(){return"{"+this.start+", "+this.length()+"}"}},{create:function(t,n){return t===void 0||null===t?null:t instanceof e?t:("object"==typeof t&&"start"in t&&"end"in t&&(n=t.end-t.start,t=t.start),new e(t,n))},create2:function(n,e){return t.isNumber(n)&&t.isNumber(e)&&(e-=n),this.create(n,e)}}}),e("tree",["lodash","cssParser","range"],function(t,n,e){function r(t,n,e,r){r=r||{},this.nameRange=t,this.valueRange=n,this.source=e,this.children=[],this.parent=null,this.type=r.type||"section",this._name=null,this._hints=r}function a(t,n){this.tokens=t,this.len=t.length,this.source=n,this.start=this.pos=0,this.root=new r(null,null,n,{type:"root"}),this.root.tokens=t,this.ctx=this.root}function i(e){var r=t.isArray(e)?e:n.lex(e);r=t.filter(r,function(t){return"comment"!==t.type});for(var a,i="",u=[],o=0,c=r.length;c>o;o++)a=r[o],","===a.type?(u.push(i.trim()),i=""):i+=a.value;return u.push(i.trim()),t.compact(u)}function u(t){for(var n,e=c;(n=t.peek())&&n.type in e;)t.next()}function o(n){u(n);var a=function(){return[n.start,n.pos]};n.start=n.pos;for(var i,c,s,p;i=n.peek();)if("@"===i.type){if(n.start=n.pos,n.skipTo(f),";"===n.peek().type){n.ctx.addChild(new r(n.curRange(!0),e.create(n.peek().start,0),n.source,{name:a()})),n.next(),u(n),n.start=n.pos;continue}}else if("{"===i.type||":"===i.type)if(c=n.curRange(!0),p=a(),n.next(),"{"===i.type){i.start;var h=n.ctx.addChild(new r(c,null,n.source,{name:p}));n.ctx=h,o(n),n.ctx=n.ctx.parent;var v=n.peek()?n.peek().start:t.last(n.tokens).end;h.valueRange=e.create2(i.start,v),u(n),n.start=n.pos}else{for(var g,m=n.pos,d=!1;g=n.next();){if("{"===g.type){n.backUp(1),d=!0;break}if(";"===g.type||"}"===g.type){n.pos=m;break}}if(d)continue;n.start=n.pos,n.skipTo(l),s=n.curRange(!0),n.ctx.addChild(new r(c,s,n.source,{type:"property",name:p})),";"===n.peek().type&&n.next(),u(n),n.start=n.pos}else{if("}"===i.type)return n.next();n.next()}}var c={white:!0,line:!0,comment:!0},f={";":!0,"{":!0},l={";":!0,"}":!0};return r.prototype={addChild:function(t){return t.parent=this,this.children.push(t),t},rawName:function(){return this.nameRange?this.nameRange.substring(this.source):""},name:function(){return null===this._name&&(this._name=i(this._nameTokens()||this.rawName().trim()).join(", ")),this._name},rawValue:function(){return this.valueRange.substring(this.source)},value:function(){return this.rawValue().trim()},valueOf:function(t){t=t||"";var n="";return this.children.forEach(function(e){n+=t+"(n)"+e.name(),n+=e.children.length?"\n"+e.valueOf(t+"	"):": (v)"+e.value()+"\n"}),n},root:function(){for(var t=this.parent;t.parent;)t=t.parent;return t},_nameTokens:function(){var t=this._hints.name;return t?this.root().tokens.slice(t[0],t[1]):void 0},range:function(){if(!this.parent)return e.create2(0,this.source);var t=this.nameRange.start,n=this.valueRange?this.valueRange.end:this.nameRange.end;return e.create2(t,n)},toSource:function(){return this.range().substring(this.source).trim()}},a.prototype={hasNext:function(){return this.pos<this.len},next:function(){return this.tokens[this.pos++]},peek:function(){return this.tokens[this.pos]},curRange:function(t){var n=this.tokens[this.start];return e.create2(n.start,this.peek()[t?"start":"end"])},backUp:function(t){this.pos-=t},skipTo:function(t){for(;++this.pos<this.len&&!(this.tokens[this.pos].type in t););}},{build:function(e){var r;t.isString(e)?r=n.parse(e):(r=e,e=n.toSource(r));for(var i=new a(r,e);i.hasNext();)o(i);return i.root},parseSelectors:i,CSSNode:r,TokenIterator:a}}),e("locator",["lodash","tree"],function(t,e){function r(t){if(!t.parent)return null;for(var n,e=t.name(),r=e.toLowerCase(),a=t.parent.children,i=1,u=0,o=a.length;a[u]!==t&&o>u;u++)n=a[u].name(),(n===e||n.toLowerCase()===r)&&i++;return[e,i]
}if("undefined"==typeof emmet)try{emmet=n("vendor/emmet")}catch(a){}return{stringifyPath:function(n){return t.isString(n)?n:n.map(function(t){return t[0]+(t[1]>1?"|"+t[1]:"")}).join("/")},createPath:function(t,n){for(var e=[];t.parent;)e.push(r(t)),t=t.parent;return e=e.reverse(),n?this.stringifyPath(e):e},parsePath:function(n){if(!t.isString(n))return n;if("["==n.charAt(0)||"{"==n.charAt(0))return JSON.parse(n);for(var e,r,a,i=[],u=/\|(\d+)$/,o=emmet.require("stringStream").create(n);r=o.next();)switch(r){case"/":e=o.current().trim(),i.push(e.substring(0,e.length-1).trim()),o.start=o.pos;break;case'"':case"'":for(;a=o.next();)if("\\"==a)o.next();else if(a==r)break}return i.push(o.current().trim()),t.compact(i).map(function(t){var n=1;return t=t.replace(u,function(t,e){return n=+e,""}),[t,n]})},normalizePath:function(t){return this.parsePath(t).map(function(t){return[e.parseSelectors(t[0]).join(", "),t[1]]})},locate:function(n,e){e=this.normalizePath(e);for(var r,a,i,u=n;(a=e.shift())&&(i=a[0].toLowerCase(),r=t.filter(u.children,function(t){var n=t.name();return n==a[0]||n.toLowerCase()==i}),u=r[a[1]-1]););return u},guessLocation:function(n,e){e=this.normalizePath(e);for(var r,a,i=function(n,e){return t.isArray(e)&&(e=e[0]),n.filter(function(t){return t.name()==e})},u=n;r=e.shift();){var o=this.locate(u,[r]);if(o||(a=i(u.children,r),a.length&&(e[0]&&(o=t.last(a.filter(function(t){return i(t.children,e[0]).length}))),o||(o=t.last(a)))),!o){e.unshift(r);break}u=o}return{found:u!==n,node:u,rest:e.length?e:null}},locateByPos:function(t,n){for(var e,r=0,a=t.children.length;a>r;r++)if(e=t.children[r],e.range().include(n))return this.locateByPos(e,n)||e}}}),e("sourcer",["lodash","tree","locator"],function(t,e,r){function a(n){return t.isString(n)?JSON.parse(n):n}function i(t,n,e){return t+e.selSep+"{"+e.indent+n+e.end+"}"}function u(n){var e,r=t.clone(s);for("property"==n.type&&(n=n.parent);n&&n.parent&&!n.children.length;)n=t.find(n.parent.children,function(t){return!!t.children.length})||n.parent;if(n.parent||(n=t.find(n.children,function(t){return!!t.children.length})),n&&n.parent){r.selSep=n.rawName().match(/([\s\n\r]+)$/)?RegExp.$1:"";try{e=emmet.require("cssEditTree").parse(n.toSource())}catch(a){}}if(e){var i=t.last(e.list());r.indent=i.styleBefore,r.sep=i.styleSeparator,r.end=e.source.substring(i.fullRange().end,e.source.length-1)}return r}function o(t,n){n&&n.length&&n.sort(function(t,n){return n.index-t.index}).forEach(function(n){if("index"in n){var e=t.get(n.index);if(e&&e.name()==n.name)return t.remove(e)}t.getAll(n.name).reverse().forEach(function(n){t.remove(n)})})}function c(n){return t.isString(n)?e.build(n):n}function f(n,e){var r={name:n.name(),value:n.value()};if(e){var a=n.parent;"indexOf"in a?r.index=a.indexOf(n):"children"in a&&(r.index=t.indexOf(a.children,n))}return r}if("undefined"==typeof emmet)try{emmet=n("vendor/emmet")}catch(l){}var s={selSep:" ",sectionSep:"\n",indent:"\n	",sep:": ",end:"\n"};return{makePatch:function(n,e,a){var i,u=[],o=[],l=c(n);if(t.isString(e)){void 0===a&&(a=this.diffPoint(n,e));var s=this.compareSections(n,e,a);u=u.concat(s.added,s.updated),o=s.removed,i=r.locateByPos(l,a),"property"==i.type&&(i=i.parent)}else{a=t.last(arguments);var p=emmet.require("cssEditTree").parseFromPosition(l.source,a,!0);if(!p)return null;i=r.locateByPos(l,p.nameRange(!0).start);var h=p.itemFromPosition(a,!0);h&&h.nameRange(!0).start==a&&(h=null),u=t.map(h?[h]:p.list(),function(t){return f(t,!0)})}return{path:r.createPath(i),properties:u,removed:o}},condensePatches:function(n){var e={},a=function(t,n){for(var e=0,r=t.length;r>e;e++)if(t[e].name===n)return t[e]};return t.each(n,function(t){var n=r.stringifyPath(t.path);n in e||(e[n]=[]),e[n].push(t)}),t.map(e,function(n){var e=t.cloneDeep(n[0]);return t.each(t.rest(n),function(n){e.removed=t.filter(e.removed,function(t){return!a(n.properties,t.name)}),e.properties=e.properties.concat(t.filter(n.properties,function(t){var n=a(e.properties,t.name);return n?(n.value=t.value,!1):!0})),e.removed=e.removed.concat(t.filter(n.removed,function(t){return!a(e.removed,t.name)}))}),e})},patchedRanges:function(n,c){c=a(c);var f;t.isString(n)?f=e.build(n):(f=n,n=f.source);var l,p,h,v,g=r.parsePath(c.path),m=s,d=r.locate(f,g);if(!d)if(v=r.guessLocation(f,g),v.rest){m=u(v.node),p=i(v.rest.pop()[0],"",t.defaults({indent:""},m));var y=v.node.parent?v.node.range().end-1:n.length;h=[y,y]}else d=v.node;d&&(p=d.toSource(),h=d.range().toArray(),m=u(d)),l=emmet.require("cssEditTree").parse(p,{styleBefore:m.indent,styleSeparator:m.sep});var b=[],x=[];if(o(l,c.removed),c.properties.forEach(function(n){var e;"index"in n&&(e=l.get(n.index),e&&e.name()==n.name||(e=t.last(l.getAll(n.name))));var r=e?[e]:l.getAll(n.name);r.length?r.forEach(function(t){b.push([t.valueRange().start,t.valueRange().end,n.value])}):x.push(n)}),x.length){var _=x.shift(),k=t.last(l.list()),C=k?k.end():"",w=l.add(_.name,_.value),j=w;x.forEach(function(t){j=l.add(t.name,t.value)});var y=w.fullRange().start;k&&k.end()!==C&&(y-=k.end().length),b.push([y,y,l.source.substring(y,j.fullRange().end)])}if(b.forEach(function(t){t[0]+=h[0],t[1]+=h[0]}),c.removed.length||v&&v.rest){var S=l.source;if(v&&v.rest)for(var R=m.indent.match(/([ \t]+)$/)?RegExp.$1:"",O=emmet.require("utils");v.rest.length;)S=i(v.rest.pop()[0],O.padString(S,R),m);var P=h[0]?m.sectionSep:"";b=[h.concat([P+S])]}return b.sort(function(t,n){return t[0]>n[0]})},applyPatch:function(n,e){var r=t.isString(n)?n:n.source;return t.isArray(e)||(e=[e]),e.forEach(function(t){var e=this.patchedRanges(n,t);e.reverse(),e.forEach(function(t){r=r.substring(0,t[0])+t[2]+r.substring(t[1])}),n=r},this),n},diffPoint:function(t,n){for(var e,r=0;e=t[r];r++)if(e!==n[r])return r;return-1},compareSections:function(t,n,r){if(void 0===r&&(r=this.diffPoint(t,n)),-1==r)throw Error("Unable to compare sources");var a=emmet.require("cssEditTree"),i=a.extractRule(t,r,!0),u=a.extractRule(n,r,!0);if(i&&u){var o=e.build(i.substring(t)).children[0],c=e.build(u.substring(n)).children[0],l=o.children,s=c.children,p=[],h=[],v=[],g=0;return s.forEach(function(t){var n=l[g];if(!n)return p.push(f(t));if(t.name()==n.name())return++g,t.value()!=n.value()&&h.push(f(t)),void 0;for(var e=g+1,r=l.length;r>e;e++)if(l[e].name()==t.name()&&l[e].value()==t.value())return v=v.concat(l.slice(g,e).map(function(t){return f(t,!0)})),g=e+1,void 0;p.push(f(t))}),v=v.concat(l.slice(g,l.length).map(function(t){return f(t,!0)})),{added:p,updated:h,removed:v}}}}}),e("backend/sublimetext",["sourcer","tree","locator"],function(t,n,e){function r(t){return t.replace(/\$/g,"\\$")}function a(t){var n={name:t[0],value:t[1]};return t.length>2&&(n.index=t[2]),n}function i(t){return"string"==typeof t?JSON.parse(t):t}return{updatedPart:function(n,e){e=i(e);var a=t.patchedRanges(n,e.patch);return a.length?(a.forEach(function(t){t[2]=r(t[2])}),JSON.stringify(a)):void 0},makeUpdatePayload:function(n){n=i(n).map(i);var e={};n.forEach(function(t){t.url in e||(e[t.url]=[]),e[t.url].push(t.patch)});var r={action:"update",data:Object.keys(e).map(function(n){return{editorFile:n,patch:t.condensePatches(e[n])}})};return JSON.stringify(r)},makePatch:function(t){t=i(t);var r=n.build(t.content),u=e.locateByPos(r,t.caret);return"property"==u.type&&(u=u.parent),JSON.stringify({url:t.url,patch:{path:e.createPath(u),properties:t.added.concat(t.updated).map(a),removed:t.removed.map(a)}})}}}),n("backend/sublimetext")});